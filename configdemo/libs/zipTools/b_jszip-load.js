(function(q){function k(a){this.data=null;this.index=this.length=0}function g(a,b){this.data=a;b||(this.data=c.utils.string2binary(this.data));this.length=this.data.length;this.index=0}function h(a){a&&(this.data=a,this.length=this.data.length,this.index=0)}function l(a){this.data=a;this.length=this.data.length;this.index=0}function n(a,b){this.options=a;this.loadOptions=b}function p(a,b){this.files=[];this.loadOptions=b;a&&this.load(a)}var c=q.JSZip,m=function(a){var b="",d,c;for(c=0;c<(a||"").length;c++)d=
a.charCodeAt(c),b+="\\x"+(16>d?"0":"")+d.toString(16).toUpperCase();return b};k.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<a||0>a)throw Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?");},setIndex:function(a){this.checkIndex(a);this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(a){},readInt:function(a){var b=0,d;this.checkOffset(a);for(d=this.index+a-1;d>=this.index;d--)b=
(b<<8)+this.byteAt(d);this.index+=a;return b},readString:function(a){return c.utils.transformTo("string",this.readData(a))},readData:function(a){},lastIndexOfSignature:function(a){},readDate:function(){var a=this.readInt(4);return new Date((a>>25&127)+1980,(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(a&31)<<1)}};g.prototype=new k;g.prototype.byteAt=function(a){return this.data.charCodeAt(a)};g.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)};g.prototype.readData=function(a){this.checkOffset(a);
var b=this.data.slice(this.index,this.index+a);this.index+=a;return b};h.prototype=new k;h.prototype.byteAt=function(a){return this.data[a]};h.prototype.lastIndexOfSignature=function(a){var b=a.charCodeAt(0),d=a.charCodeAt(1),c=a.charCodeAt(2);a=a.charCodeAt(3);for(var e=this.length-4;0<=e;--e)if(this.data[e]===b&&this.data[e+1]===d&&this.data[e+2]===c&&this.data[e+3]===a)return e;return-1};h.prototype.readData=function(a){this.checkOffset(a);var b=this.data.subarray(this.index,this.index+a);this.index+=
a;return b};l.prototype=new h;l.prototype.readData=function(a){this.checkOffset(a);var b=this.data.slice(this.index,this.index+a);this.index+=a;return b};n.prototype={isEncrypted:function(){return 1===(this.bitFlag&1)},useUTF8:function(){return 2048===(this.bitFlag&2048)},prepareCompressedContent:function(a,b,c){return function(){var f=a.index;a.setIndex(b);var e=a.readData(c);a.setIndex(f);return e}},prepareContent:function(a,b,d,f,e){return function(){var a=c.utils.transformTo(f.uncompressInputType,
this.getCompressedContent()),a=f.uncompress(a);if(a.length!==e)throw Error("Bug : uncompressed data size mismatch");return a}},readLocalPart:function(a){var b,d;a.skip(22);this.fileNameLength=a.readInt(2);d=a.readInt(2);this.fileName=a.readString(this.fileNameLength);a.skip(d);if(-1==this.compressedSize||-1==this.uncompressedSize)throw Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");a:{d=this.compressionMethod;
for(b in c.compressions)if(c.compressions.hasOwnProperty(b)&&c.compressions[b].magic===d){b=c.compressions[b];break a}b=null}if(null===b)throw Error("Corrupted zip : compression "+m(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");this.decompressed=new c.CompressedObject;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=
this.prepareCompressedContent(a,a.index,this.compressedSize,b);this.decompressed.getContent=this.prepareContent(a,a.index,this.compressedSize,b,this.uncompressedSize);if(this.loadOptions.checkCRC32&&(this.decompressed=c.utils.transformTo("string",this.decompressed.getContent()),c.prototype.crc32(this.decompressed)!==this.crc32))throw Error("Corrupted zip : CRC32 mismatch");},readCentralPart:function(a){this.versionMadeBy=a.readString(2);this.versionNeeded=a.readInt(2);this.bitFlag=a.readInt(2);this.compressionMethod=
a.readString(2);this.date=a.readDate();this.crc32=a.readInt(4);this.compressedSize=a.readInt(4);this.uncompressedSize=a.readInt(4);this.fileNameLength=a.readInt(2);this.extraFieldsLength=a.readInt(2);this.fileCommentLength=a.readInt(2);this.diskNumberStart=a.readInt(2);this.internalFileAttributes=a.readInt(2);this.externalFileAttributes=a.readInt(4);this.localHeaderOffset=a.readInt(4);if(this.isEncrypted())throw Error("Encrypted zip are not supported");this.fileName=a.readString(this.fileNameLength);
this.readExtraFields(a);this.parseZIP64ExtraField(a);this.fileComment=a.readString(this.fileCommentLength);this.dir=this.externalFileAttributes&16?!0:!1},parseZIP64ExtraField:function(a){this.extraFields[1]&&(a=new g(this.extraFields[1].value),-1===this.uncompressedSize&&(this.uncompressedSize=a.readInt(8)),-1===this.compressedSize&&(this.compressedSize=a.readInt(8)),-1===this.localHeaderOffset&&(this.localHeaderOffset=a.readInt(8)),-1===this.diskNumberStart&&(this.diskNumberStart=a.readInt(4)))},
readExtraFields:function(a){var b=a.index,c,f,e;for(this.extraFields=this.extraFields||{};a.index<b+this.extraFieldsLength;)c=a.readInt(2),f=a.readInt(2),e=a.readString(f),this.extraFields[c]={id:c,length:f,value:e}},handleUTF8:function(){this.useUTF8()&&(this.fileName=c.prototype.utf8decode(this.fileName),this.fileComment=c.prototype.utf8decode(this.fileComment))}};p.prototype={checkSignature:function(a){var b=this.reader.readString(4);if(b!==a)throw Error("Corrupted zip or bug : unexpected signature ("+
m(b)+", expected "+m(a)+")");},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);this.zipComment=this.reader.readString(this.zipCommentLength)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=
this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};for(var a=this.zip64EndOfCentralSize-44,b,c,f;0<a;)b=this.reader.readInt(2),c=this.reader.readInt(4),
f=this.reader.readString(c),this.zip64ExtensibleData[b]={id:b,length:c,value:f}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(1<this.disksCount)throw Error("Multi-volumes zip are not supported");},readLocalFiles:function(){var a,b;for(a=0;a<this.files.length;a++)b=this.files[a],this.reader.setIndex(b.localHeaderOffset),this.checkSignature(c.signature.LOCAL_FILE_HEADER),
b.readLocalPart(this.reader),b.handleUTF8()},readCentralDir:function(){var a;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===c.signature.CENTRAL_FILE_HEADER;)a=new n({zip64:this.zip64},this.loadOptions),a.readCentralPart(this.reader),this.files.push(a)},readEndOfCentral:function(){var a=this.reader.lastIndexOfSignature(c.signature.CENTRAL_DIRECTORY_END);if(-1===a)throw Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(a);this.checkSignature(c.signature.CENTRAL_DIRECTORY_END);
this.readBlockEndOfCentral();if(65535===this.diskNumber||65535===this.diskWithCentralDirStart||65535===this.centralDirRecordsOnThisDisk||65535===this.centralDirRecords||-1===this.centralDirSize||-1===this.centralDirOffset){this.zip64=!0;a=this.reader.lastIndexOfSignature(c.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(-1===a)throw Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(a);this.checkSignature(c.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);
this.readBlockZip64EndOfCentralLocator();this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(c.signature.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}},prepareReader:function(a){var b=c.utils.getTypeOf(a);this.reader="string"!==b||c.support.uint8array?"nodebuffer"===b?new l(a):new h(c.utils.transformTo("uint8array",a)):new g(a,this.loadOptions.optimizedBinaryString)},load:function(a){this.prepareReader(a);this.readEndOfCentral();this.readCentralDir();
this.readLocalFiles()}};c.prototype.load=function(a,b){var d,f,e;b=b||{};b.base64&&(a=c.base64.decode(a));d=(new p(a,b)).files;for(f=0;f<d.length;f++)e=d[f],this.file(e.fileName,e.decompressed,{binary:!0,optimizedBinaryString:!0,date:e.date,dir:e.dir});return this}})(this);